# 02.JavaScript 런타임 동작방식, 비동기 처리

JavaScript 는 싱글 스레드 방식을 채택한 언어로 한 번에 한 가지 작업만을 처리할 수 있다. 그런데 JavaScript 에서 비동기 처리가 가능하다는 말을 한 번쯤은 들어본 적이 있을 것이다.
싱글 스레드인데 어떻게 여러 작업을 동시에 처리하는 비동기 처리가 가능할까? 그 이유는 웹 브라우저나 Node.js 같이 JavaScript 가 실행되는 런타임(Runtime)은 멀티 스레드 방식이기 때문이다. 
실제로 웹 브라우저에서는 처리해야 할 작업들이 많다. 네트워크 요청, 이벤트 처리, 파일 다운로드 등 수많은 작업들을 싱글 스레드 방식으로 처리한다면 한 작업이 끝날 때까지 대기하기 때문에 
브라우저의 로딩 시간이 엄청 길어질 것이다. 

이러한 상황을 방지하기 위해 브라우저를 포함한 JavaScript 런타임은 멀티 스레드 방식을 채택하여 작업을 처리한다. 
JavaScript 런타임은 작업을 처리하기 위한 여러가지 요소로 구성되어 있다.

## JavaScript 엔진, 호출 스택
JavaScript 엔진이란 런타임 내에서 JavaScript 코드를 해석하는 역할을 한다. 초기의 JavaScript 는 웹개발을 위해 사용된 언어인만큼 브라우저에서 
실행되는 다양한 종류의 엔진들이 있다. 주로 사용되는 엔진의 종류들은 다음과 같다.

* V8 : Google Chrome, Node.js
* Rhino : Mozilla
* SpiderMonkey : Mozilla/Firefox
* Chakra : Microsoft/IE 9+ Edge browser

이 중 Chrome 브라우저와 Node.js 에서 사용되는 V8 엔진이 가장 유명하고 대중적이다. 이 글에서는 V8 엔진을 기준으로 동작 원리를 설명할 예정이다.

V8 엔진은 메모리 힙(Heap) 과 호출 스택으로 구성되어 있다. 메모리 힙은 동적 메모리 할당을 위한 공간이다. 호출 스택은 프로그램 실행 시 현재 어느 위치에 
있는지를 기록하는 스택(stack) 자료구조이다. 

예를 들어 다음 코드를 실행한다고 가정하면

```.js
function greeting() {
  // Some codes to execute
  sayHi();
}
function sayHi() {
  // Some codes to execute
  return "Hi!";
}

greeting();
```

호출 스택에는 greeting 과 sayHi 가 추가된다. 자세한 동작 과정은 다음과 같다.

1. greeting 이 호출 스택에 먼저 추가되고 greeting 의 내부 코드를 실행한다.
2. sayHi 함수에 도달하면서 sayHi 를 호출 스택에 추가하고 sayHi 함수 내 모든 코드를 실행한다. 
3. 실행이 완료되면 다시 greeting 함수 내의 나머지 코드를 마저 실행하고 sayHi 를 호출 스택에서 제거한다.
4. greeting 함수의 실행이 완료되고 호출 스택에서 greeting 을 제거한다.

V8 엔진에는 메모리 힙과 호출 스택이 하나밖에 없기 때문에 한 번에 한 가지 작업만 처리할 수 있다.

## Web APIs
